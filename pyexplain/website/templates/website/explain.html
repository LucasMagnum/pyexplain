{% extends 'website/base.html' %}
{% load staticfiles utils_tags %}

{% block head %}
<link href="{% static 'website/css/prettify.css' %}" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="{% static 'website/js/prettify.js' %}"></script>

<style type="text/css">
  /* reset the 'a' color */
  pre a {color:inherit !important;}
  pre a:hover{color:inherit !important;}
  .popover{color:#000;}
  .popover-title{font-weight: bold;}
  .popover-content{word-break:break-word;}
</style>
{% endblock head %}

{% block body %}
  {% if code %}
    <pre class="col-xs-12 prettyprint linenums language-python skin-desert">{{ code }}</pre>
  {% endif %}
{% endblock body %}

{% block scripts %}
<script type="text/javascript">

  function show_links(){
    keywords = {
      {% for keyword in keywords %}
        '{{ keyword.codname }}': {
          'url': '{{ keyword.get_url }}',
          'desc': '{{ keyword.description|to_html }}'
        }{% if not forloop.last %},{% endif %}
      {% endfor %}
    }

    $('.kwd, .pln').each(function(){
      keyword = $(this);
      original_text = $(this).text();
      text = original_text.trim();
      if (keywords.hasOwnProperty(text)){
        url = keywords[text].url;
        desc = keywords[text].desc;
        keyword.html("<a data-toggle='popover' data-placement='bottom' data-title='"+ text +"' data-content='"+ desc +"' data-html=true href='" + url + "' target='_blank'>" + original_text + "</a>");
      };
    });
  }

  $(function(){
    prettyPrint();
    show_links();

    $('a[data-toggle=popover]').hover(function(){
      $(this).popover('show');
    });

    $('a[data-toggle=popover]').mouseout(function(){
      $(this).popover('destroy');
    });

  });
</script>
{% endblock scripts %}